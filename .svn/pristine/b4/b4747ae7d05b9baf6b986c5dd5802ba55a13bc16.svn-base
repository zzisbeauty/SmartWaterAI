<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hanwei.core.base.mapper.SysDictMapper">

	<!-- 查询字典表的数据 支持设置过滤条件、设置存储值作为in查询条件 -->
	<select id="queryTableDictByKeysAndFilterSql" parameterType="String" resultType="com.hanwei.core.base.vo.DictModel">
		select ${text} as "text", ${code} as "value" from ${table} where 1=1
		<if test="codeValues.get(0) != null and codeValues.get(0) != ''">
			and ${code} IN (
			<foreach item="key" collection="codeValues" separator=",">
				#{key}
			</foreach>
			)
		</if>
		<if test="filterSql != null and filterSql != ''">
			and ${filterSql}
		</if>
	</select>

	<!-- 通过字典code获取字典数据，可批量查询 -->
	<select id="queryManyDictByKeys" parameterType="String"  resultType="com.hanwei.core.base.vo.DictModelMany">
		SELECT
		dict.dict_code,
		item.item_text AS "text",
		item.item_value AS "value"
		FROM
		sys_dict_item item
		INNER JOIN sys_dict dict ON dict.id = item.dict_id
		WHERE dict.dict_code IN (
		<foreach item="dictCode" collection="dictCodeList" separator=",">
			#{dictCode}
		</foreach>
		)
		AND item.item_value IN (
		<foreach item="key" collection="keys" separator=",">
			#{key}
		</foreach>
		)
	</select>

	<!-- 通过字典code获取字典数据 -->
	<select id="queryDictTextByKey" parameterType="String"  resultType="String">
		select s.item_text from sys_dict_item s
		where s.dict_id = (select id from sys_dict where dict_code = #{code})
		  and s.item_value = #{key}
	</select>

	<!-- 通过字典code获取字典数据 -->
	<select id="queryDictItemsByCode" parameterType="String"  resultType="com.hanwei.core.base.vo.DictModel">
		select s.item_value as "value",s.item_text as "text" from sys_dict_item s
		where dict_id = (select id from sys_dict where dict_code = #{code})
		order by s.sort_order asc
	</select>

	<!-- 通过字典code获取有效的字典数据项 -->
	<select id="queryEnableDictItemsByCode" parameterType="String"  resultType="com.hanwei.core.base.vo.DictModel">
		select s.item_value as "value",s.item_text as "text" from sys_dict_item s
		where dict_id = (select id from sys_dict where dict_code = #{code})
		  and s.status = 1
		order by s.sort_order asc
	</select>

	<!-- 通过多个字典code获取字典数据 -->
	<select id="queryDictItemsByCodeList" parameterType="String" resultType="com.hanwei.core.base.vo.DictModelMany">
		SELECT
		dict.dict_code,
		item.item_text AS "text",
		item.item_value AS "value"
		FROM
		sys_dict_item item
		INNER JOIN sys_dict dict ON dict.id = item.dict_id
		WHERE dict.dict_code IN (
		<foreach item="dictCode" collection="dictCodeList" separator=",">
			#{dictCode}
		</foreach>
		)
		ORDER BY item.sort_order ASC
	</select>


	<select id="translateDictTextToKey" parameterType="String"  resultType="String">
		select s.item_value from sys_dict_item s
		where s.dict_id = (select id from sys_dict where dict_code = #{code})
		  and s.item_text = #{text}
	</select>

</mapper>
